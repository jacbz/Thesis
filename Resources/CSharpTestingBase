public static bool CIEquals(this String a, String b) {
    return a.Equals(b, StringComparison.CurrentCultureIgnoreCase);
}

public static bool IsNumeric(this object o) => o is double || o is int || o is ushort || o is uint || o is ulong ||
												  o is short || o is sbyte || o is long || o is float || o is byte ||
												  o is decimal;

// same as Object.Equals, but returns true for numbers of different types
public static bool Equals(object a, object b)
{
	if (IsNumeric(a) && IsNumeric(b))
	{
		return double.Equals(Convert.ToDouble(a), Convert.ToDouble(b));
	}
	return Object.Equals(a, b);
}

public struct EmptyCell
{
    public static dynamic operator +(dynamic a, EmptyCell b)
    {
        return a;
    }

    public static dynamic operator +(EmptyCell a, dynamic b)
    {
        return b;
    }

    public static EmptyCell operator +(EmptyCell a, EmptyCell b)
    {
        return a;
    }

    public static dynamic operator -(dynamic a, EmptyCell b)
    {
        return a;
    }

    public static dynamic operator -(EmptyCell a, dynamic b)
    {
        return 0 - b;
    }

    public static dynamic operator -(EmptyCell a, EmptyCell b)
    {
        return 0;
    }

    public static dynamic operator *(dynamic a, EmptyCell b)
    {
        return 0;
    }

    public static dynamic operator *(EmptyCell a, dynamic b)
    {
        return 0;
    }

    public static dynamic operator *(EmptyCell a, EmptyCell b)
    {
        return 0;
    }

    public static dynamic operator /(dynamic a, EmptyCell b)
    {
        throw new System.DivideByZeroException();
    }

    public static dynamic operator /(EmptyCell a, dynamic b)
    {
        return 0;
    }

    public static dynamic operator /(EmptyCell a, EmptyCell b)
    {
        throw new System.DivideByZeroException();
    }

    public static dynamic operator %(dynamic a, EmptyCell b)
    {
        throw new System.DivideByZeroException();
    }

    public static dynamic operator %(EmptyCell a, dynamic b)
    {
        return 0;
    }

    public static dynamic operator %(EmptyCell a, EmptyCell b)
    {
        throw new System.DivideByZeroException();
    }

    public static bool operator ==(dynamic a, EmptyCell empty)
    {
        if (IsNumeric(a)) return a == 0;
        switch (a)
        {
            case string s:
                return s == "";
            case bool b:
                return b == false;
            default:
                return false;
        }
    }

    public static bool operator ==(EmptyCell a, dynamic b)
    {
        return b == a;
    }

    public static bool operator ==(EmptyCell a, EmptyCell b)
    {
        return true;
    }

    public static bool operator !=(dynamic a, EmptyCell b)
    {
        return !(a == b);
    }

    public static bool operator !=(EmptyCell a, dynamic b)
    {
        return !(b == a);
    }

    public static bool operator !=(EmptyCell a, EmptyCell b)
    {
        return false;
    }

    public static bool operator <(dynamic a, EmptyCell b)
    {
        return a < 0;
    }

    public static bool operator <(EmptyCell a, dynamic b)
    {
        return 0 < b;
    }

    public static bool operator <(EmptyCell a, EmptyCell b)
    {
        return false;
    }

    public static bool operator >(dynamic a, EmptyCell b)
    {
        return a > 0;
    }

    public static bool operator >(EmptyCell a, dynamic b)
    {
        return 0 > b;
    }

    public static bool operator >(EmptyCell a, EmptyCell b)
    {
        return false;
    }

    public static bool operator <=(dynamic a, EmptyCell b)
    {
        return a <= 0;
    }

    public static bool operator <=(EmptyCell a, dynamic b)
    {
        return 0 <= b;
    }

    public static bool operator <=(EmptyCell a, EmptyCell b)
    {
        return true;
    }

    public static bool operator >=(dynamic a, EmptyCell b)
    {
        return a >= 0;
    }

    public static bool operator >=(EmptyCell a, dynamic b)
    {
        return 0 >= b;
    }

    public static bool operator >=(EmptyCell a, EmptyCell b)
    {
        return true;
    }

    public static dynamic operator !(EmptyCell a)
    {
        return true;
    }

    public static implicit operator double(EmptyCell a) => 0;
    public static implicit operator string(EmptyCell a) => "";
    public static implicit operator bool(EmptyCell a) => false;

    public override bool Equals(object obj)
    {
        return obj == this;
    }

    public override int GetHashCode()
    {
        return 0;
    }
}